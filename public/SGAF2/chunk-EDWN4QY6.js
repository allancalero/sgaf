import{f as g}from"./chunk-XROZH2JP.js";import{Ac as p,K as n,P as s,T as a,h as u,k as h,o as b,vc as l,xc as c,z as m}from"./chunk-KK5YFQP7.js";var f=class i{constructor(t,r){this.http=t;this.router=r}apiUrl=p.apiUrl;currentUserSubject=new u(null);currentUser=this.currentUserSubject.asObservable();login(t){return this.http.post(`${this.apiUrl}/login`,t).pipe(n(r=>{r.user&&(localStorage.setItem("user",JSON.stringify(r.user)),this.currentUserSubject.next(r.user))}))}logout(){localStorage.removeItem("user"),this.currentUserSubject.next(null),this.router.navigate(["/login"]),this.http.post(`${this.apiUrl}/logout`,{}).subscribe({next:()=>console.log("Backend logout success"),error:t=>console.warn("Backend logout failed or token already invalid",t)})}checkAuthStatus(){return this.http.get(`${this.apiUrl}/user`).pipe(n(t=>{localStorage.setItem("user",JSON.stringify(t)),this.currentUserSubject.next(t)}),b(()=>!0),m(()=>(localStorage.removeItem("user"),this.currentUserSubject.next(null),h(!1))))}getToken(){return null}isLoggedIn(){return!!this.currentUserSubject.value}changePassword(t,r,e){return this.http.post(`${this.apiUrl}/change-password`,{current_password:t,new_password:r,new_password_confirmation:e}).pipe(n(()=>{let o=this.currentUserSubject.value;o&&(o.must_change_password=!1,localStorage.setItem("user",JSON.stringify(o)),this.currentUserSubject.next(o))}))}static \u0275fac=function(r){return new(r||i)(a(c),a(g))};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})};var v=class i{constructor(t){this.http=t}apiUrl=p.apiUrl;getDepreciacion(t=1,r=""){let e=new l().set("page",t.toString());return r&&(e=e.set("search",r)),this.http.get(`${this.apiUrl}/depreciacion`,{params:e})}getSinConfigurar(t=1,r=""){let e=new l().set("page",t.toString());return r&&(e=e.set("search",r)),this.http.get(`${this.apiUrl}/depreciacion/sin-configurar`,{params:e})}getCatalogo(){return this.http.get(`${this.apiUrl}/depreciacion/catalogo`)}configurar(t,r){return this.http.post(`${this.apiUrl}/depreciacion/${t}/configurar`,r)}calcular(t){return this.http.post(`${this.apiUrl}/depreciacion/${t}/calcular`,{})}resetear(){return this.http.post(`${this.apiUrl}/depreciacion/reset`,{})}limpiarTodo(){return this.http.post(`${this.apiUrl}/depreciacion/limpiar-todo`,{})}procesarMasivo(t){let r=t?{fecha_corte:t}:{};return this.http.post(`${this.apiUrl}/depreciacion/procesar`,r)}static \u0275fac=function(r){return new(r||i)(a(c))};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})};export{f as a,v as b};
