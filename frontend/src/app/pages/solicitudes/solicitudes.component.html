<div class="p-6 animate-fade-in">
    <div class="mb-10 animate-fade-in">
        <h1 class="text-4xl font-orbitron font-black text-white tracking-tighter uppercase leading-none">Solicitudes de
            Baja</h1>
        <p class="text-red-500/80 mt-3 text-sm font-black uppercase tracking-[0.3em]">Gesti贸n de solicitudes de
            eliminaci贸n de activos.</p>
    </div>

    <div
        class="bg-black/40 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-10 shadow-2xl relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-[2px] bg-gradient-to-r from-transparent via-red-600 to-transparent">
        </div>

        <!-- Loading State -->
        <div *ngIf="isLoading()" class="flex flex-col items-center justify-center p-20 gap-6">
            <div class="relative">
                <div class="w-16 h-16 rounded-full border-t-2 border-red-600 animate-spin"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <i class="fas fa-satellite-dish text-red-500 animate-pulse"></i>
                </div>
            </div>
            <p class="text-[10px] font-black text-red-500 uppercase tracking-[0.4em]">Sincronizando registros...</p>
        </div>

        <!-- Empty State -->
        <div *ngIf="!isLoading() && solicitudes().length === 0" class="text-center py-24">
            <div
                class="w-24 h-24 bg-red-600/10 border border-red-600/20 rounded-[2rem] flex items-center justify-center mx-auto mb-8 shadow-2xl relative group">
                <div
                    class="absolute inset-0 bg-red-600/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity">
                </div>
                <i class="fas fa-check-double text-4xl text-red-500 relative z-10"></i>
            </div>
            <h3 class="text-2xl font-orbitron font-black text-white uppercase tracking-tighter mb-4">Protocolo de Bajas
                Limpio</h3>
            <p class="text-[10px] font-black text-white/30 uppercase tracking-[0.4em]">No existen solicitudes pendientes
                de resoluci贸n.</p>
        </div>

        <!-- Table -->
        <div *ngIf="!isLoading() && solicitudes().length > 0" class="overflow-x-auto">
            <table class="w-full text-left">
                <thead>
                    <tr
                        class="bg-black/40 text-white/40 text-[9px] font-black uppercase tracking-[0.3em] border-b border-white/5">
                        <th class="py-5 px-6">Registro</th>
                        <th class="py-5 px-6">Identificador / Activo</th>
                        <th class="py-5 px-6">Usuario</th>
                        <th class="py-5 px-6">Motivo Requerido</th>
                        <th class="py-5 px-6">Estatus</th>
                        <th class="py-5 px-6 text-right">Determinaci贸n</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-white/5 font-medium">
                    <tr *ngFor="let s of solicitudes()" class="hover:bg-white/[0.03] transition-all duration-300 group">
                        <td class="py-6 px-6">
                            <span class="text-[10px] font-black font-mono text-red-500/60 uppercase tracking-widest">{{
                                s.created_at | date:'dd.MM.yy' }}</span>
                        </td>
                        <td class="py-6 px-6">
                            <div class="flex items-center gap-4">
                                <div
                                    class="w-10 h-10 rounded-xl bg-red-600/10 flex items-center justify-center border border-red-600/20">
                                    <i class="fas fa-box text-red-500 text-xs"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-black text-white uppercase tracking-tight">{{
                                        s.activo?.codigo_inventario || 'S/N' }}</div>
                                    <div class="text-[10px] font-bold text-white/30 uppercase tracking-tighter">{{
                                        s.activo?.nombre_activo || 'ACTIVO DESCONTINUADO' }}</div>
                                </div>
                            </div>
                        </td>
                        <td class="py-6 px-6 text-[10px] font-black text-white/60 uppercase tracking-widest">
                            {{ s.solicitante?.name || 'SISTEMA' }}
                        </td>
                        <td class="py-6 px-6">
                            <p class="text-[10px] font-bold text-white/40 uppercase tracking-tight max-w-xs truncate"
                                [title]="s.motivo">
                                {{ s.motivo }}
                            </p>
                        </td>
                        <td class="py-6 px-6">
                            <span class="px-3 py-1.5 rounded-xl text-[9px] font-black uppercase border tracking-[0.2em]"
                                [ngClass]="{
                                    'bg-amber-500/10 text-amber-500 border-amber-500/20': s.estado === 'PENDIENTE',
                                    'bg-emerald-500/10 text-emerald-500 border-emerald-500/20': s.estado === 'APROBADO',
                                    'bg-red-500/10 text-red-500 border-red-500/20': s.estado === 'RECHAZADO'
                                }">
                                {{ s.estado }}
                            </span>
                        </td>
                        <td class="py-6 px-6 text-right">
                            <div class="flex justify-end gap-2" *ngIf="s.estado === 'PENDIENTE' && isAdmin()">
                                <button (click)="approve(s)"
                                    class="w-10 h-10 flex items-center justify-center rounded-xl bg-emerald-600/10 text-emerald-500 hover:bg-emerald-600 hover:text-white transition-all active:scale-90 border border-emerald-600/20"
                                    title="Aprobar Solicitud">
                                    <i class="fas fa-check-circle text-xs"></i>
                                </button>
                                <button (click)="reject(s)"
                                    class="w-10 h-10 flex items-center justify-center rounded-xl bg-red-600/10 text-red-500 hover:bg-red-600 hover:text-white transition-all active:scale-90 border border-red-600/20 shadow-lg shadow-red-600/5"
                                    title="Rechazar Solicitud">
                                    <i class="fas fa-times-circle text-xs"></i>
                                </button>
                            </div>
                            <span *ngIf="s.estado !== 'PENDIENTE'"
                                class="text-[9px] text-white/20 font-black uppercase tracking-[0.2em]">
                                {{ s.estado === 'APROBADO' ? 'REGISTRO PROCESADO' : 'SOLICITUD FINALIZADA' }}
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>