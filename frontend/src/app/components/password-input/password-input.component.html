<div class="password-field-container">
    <label *ngIf="label" class="form-label">{{ label }}</label>
    <div class="input-group">
        <input [type]="isVisible ? 'text' : 'password'" [placeholder]="placeholder" [class]="inputClass"
            [class.is-invalid]="control.invalid && control.touched" (input)="onInput($event)" (blur)="onTouch()"
            [value]="control.value" style="padding-right: 40px;">

        <button type="button" class="btn-toggle-visibility" (click)="toggleVisibility()"
            [attr.aria-label]="isVisible ? 'Ocultar contraseña' : 'Mostrar contraseña'">
            <fa-icon [icon]="isVisible ? faEyeSlash : faEye"></fa-icon>
        </button>
    </div>

    <!-- Real-time Validation Checklist -->
    <div *ngIf="showValidation && control.value" class="validation-checklist mt-2 p-2 rounded">
        <small class="d-block mb-1 text-muted">Requisitos de seguridad:</small>
        <div class="requirement-item" [class.valid]="hasMinLength">
            <i class="fas" [class.fa-check-circle]="hasMinLength" [class.fa-circle]="!hasMinLength"></i> Mínimo 8
            caracteres
        </div>
        <div class="requirement-item" [class.valid]="hasUpperCase">
            <i class="fas" [class.fa-check-circle]="hasUpperCase" [class.fa-circle]="!hasUpperCase"></i> Al menos 1
            mayúscula
        </div>
        <div class="requirement-item" [class.valid]="hasNumber">
            <i class="fas" [class.fa-check-circle]="hasNumber" [class.fa-circle]="!hasNumber"></i> Al menos 1 número
        </div>
        <div class="requirement-item" [class.valid]="hasSpecialChar">
            <i class="fas" [class.fa-check-circle]="hasSpecialChar" [class.fa-circle]="!hasSpecialChar"></i> Carácter
            especial (@$!%*#?&)
        </div>
    </div>
</div>